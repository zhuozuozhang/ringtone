<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<title>号码列表</title>
<link rel="stylesheet" type="text/css" th:href="@{/client/threenets/css/index.css}">
<head th:include="threenets/threenet/common/head :: linkcss"></head>
<body>
    <!-- 头部 -->
    <div th:include="threenets/threenet/common/include :: header"></div>
    <div class="layui-row contant">
        <!-- 等待设置铃音 -->
        <div class="layui-col-md12">
            <div class="layui-form-item" style='text-align: right;'>
                <div class="layui-inline">
                    <label class="layui-form-label">用户状态</label>
                    <div class="layui-input-inline">
                        <select id="memberStatus" lay-verify="required" name="crbtStatus" value="1" style="width:107%;" onchange="showTable()">
                            <option value="1" selected="selected">未包月</option>
                            <option value="2">已包月</option>
                            <option value="4">已包月未设置</option>
                            <option value="3">已退订</option>
                        </select>
                    </div>
                </div>
                <div class="layui-inline">
                    <label class="layui-form-label">时间段</label>
                    <div class="layui-input-inline">
                        <select id="timeType" lay-verify="required" name="timeType" value="" style="width:90px;" onchange="showTable()">
                            <option value="1" selected="selected">一天</option>
                            <option value="2">一周</option>
                            <option value="3">半个月</option>
                            <option value="4">一个月</option>
                        </select>
                    </div>
                </div>
            </div>
            <table class="layui-table" id="set">
                <thead>
                    <tr>
                        <th>编号</th>
                        <th>成员号码</th>
                        <th>员工姓名</th>
                        <th>商户名称</th>
                        <th>省份</th>
                        <th>加入时间</th>
                        <th>铃音</th>
                        <th>企业彩铃</th>
                        <th>视频彩铃</th>
                        <th>备注</th>
                        <th>操作</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
</body>
<div th:include="threenets/threenet/common/head :: footer"></div>
<script>
    $(".index3").addClass("active");
    //分页
    $(document).ready(function() {
        showTable();
    });

    function showTable() {
        let params = {
            "isMonthly" : $('#memberStatus option:selected').val(),
            "timeType" : $('#timeType option:selected').val(),
        }
        var columns = [
            {"data": "id"},
            {"data": "linkmanTel"},
            {"data": "linkman"},
            {"data": "companyLinkman"},
            {"data": "province"},
            {"data": "createDate"},
            {"data": "ringName"},
            {"data": "isMonthly"},
            {"data": "isVideoUser"},
            {"data": "remark"}
        ];
        var columnDefs = [{
            targets:[2],
            render:function (data,type,row,meta) {
                return "<div style='text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:100px;' title='" + data + "'>" + data + "</div>";
            }
        },{
            targets: [3],
            render: function (data, type, row, meta) {
                var number = data.substring(data.length - 6,data.length)
                var companyName = data;
                if(!isNaN(number)){
                    companyName = data.substring(0,data.length-6);
                }
                var id = row.parentOrderId;
                return "<div style='text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:150px;' title='" + data + "'><a href='/threenets/toMerchantsPhonePage/" + id + "'>"+companyName+"</a></div>";
            }
        },{
            targets:[6],
            render:function (data,type,row,meta) {
                data = isNotEmpty(data)?data:"";
                return "<div style='text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:150px;' title='" + data + "'>" + data + "</div>";
            }
        },{
            targets:[7],
            render:function (data,type,row,meta) {
                if (data == 1){
                    return '未包月'
                } else if(data == 2){
                    return '已包月'
                }else{
                    return '已退订'
                }
            }
        },{
            targets:[8],
            render:function (data,type,row,meta) {
                return data?'是':'否';
            }
        },{
            targets:[9],
            render:function (data,type,row,meta) {
                data = isNotEmpty(data)?data:"";
                return "<div style='text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:150px;' title='" + data + "'>" + data + "</div>";
            }
        },{
            targets: [10],
            render: function(data, type, row, meta) {
                var id = row.id;
                return "<a href='/threenets/toMerchantsPhonePage/"+row.parentOrderId+"'><i class='layui-icon layui-icon-user' title='进入商户'></i></a>"
            }
        }]
        page("#set",15,params,"/threenets/getThreeNetsTaskList",columns,columnDefs);
    }
</script>
</html>
